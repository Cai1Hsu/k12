(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{"6/gD":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("mrSG"),o=n("AytR"),r=n("a/9d"),a=n("fXoL");let s=(()=>{class e{constructor(e){this.camera=e,this.photos=[],this.photo_info=[]}add_new(){return Object(i.a)(this,void 0,void 0,(function*(){const e={quality:o.a.quality,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,sourceType:this.camera.PictureSourceType.CAMERA,correctOrientation:!1,saveToPhotoAlbum:!1,targetWidth:o.a.image_width,targetHeight:o.a.image_height};var t=yield this.camera.getPicture(e);this.photo_info.push({base64:"data:image/jpeg;base64,"+t,ext:".jpg",name:"",url:""})}))}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](r.a))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"Ql/B":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("ofXK"),o=n("TEn/"),r=n("3Pt+"),a=n("UMfn"),s=n("xiOZ"),l=n("/l6y"),c=n("L1u3"),d=n("8pq7"),u=n("ZE2D"),m=n("DKVz"),h=n("DXzV"),p=n("fXoL");let f=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.CommonModule,o.IonicModule,r.FormsModule,a.a,s.b,l.d,d.c,d.b,d.e,d.a,d.f,c.b,m.a,u.b,h.b],a.a,c.b,d.c,d.b,d.e,d.a,d.f,u.b,h.b]}),e})()},ZE2D:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return v}));var i=n("207e"),o=n("JMSK"),r=n("fXoL"),a=n("2Suw"),s=n("/KA4"),l=n("IjuJ"),c=n("ofXK"),d=n("FwiY");const u=["textEl"];function m(e,t){if(1&e&&r["\u0275\u0275element"](0,"i",3),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("nzType",e.nzIcon)}}function h(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"img",4),r["\u0275\u0275listener"]("error",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().imgError(t)})),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("src",e.nzSrc,r["\u0275\u0275sanitizeUrl"]),r["\u0275\u0275attribute"]("srcset",e.nzSrcSet,r["\u0275\u0275sanitizeUrl"])("alt",e.nzAlt)}}function p(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"span",5,6),r["\u0275\u0275text"](2),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("ngStyle",e.textStyles),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](e.nzText)}}const f=["*"];let g=(()=>{class e{constructor(e,t,n,i){this.nzConfigService=e,this.elementRef=t,this.cdr=n,this.platform=i,this._nzModuleName="avatar",this.nzShape="circle",this.nzSize="default",this.nzGap=4,this.nzError=new r.EventEmitter,this.hasText=!1,this.hasSrc=!0,this.hasIcon=!1,this.textStyles={},this.classMap={},this.customSize=null,this.el=this.elementRef.nativeElement,this.elementRef.nativeElement.classList.add("ant-avatar")}imgError(e){this.nzError.emit(e),e.defaultPrevented||(this.hasSrc=!1,this.hasIcon=!1,this.hasText=!1,this.nzIcon?this.hasIcon=!0:this.nzText&&(this.hasText=!0),this.cdr.detectChanges(),this.setSizeStyle(),this.notifyCalc())}ngOnChanges(){this.hasText=!this.nzSrc&&!!this.nzText,this.hasIcon=!this.nzSrc&&!!this.nzIcon,this.hasSrc=!!this.nzSrc,this.setSizeStyle(),this.notifyCalc()}calcStringSize(){if(!this.hasText)return;const e=this.textEl.nativeElement.offsetWidth,t=this.el.getBoundingClientRect().width,n=2*this.nzGap<t?2*this.nzGap:8;this.textStyles={transform:`scale(${t-n<e?(t-n)/e:1}) translateX(-50%)`},this.customSize&&Object.assign(this.textStyles,{lineHeight:this.customSize}),this.cdr.detectChanges()}notifyCalc(){this.platform.isBrowser&&setTimeout(()=>{this.calcStringSize()})}setSizeStyle(){this.customSize="number"==typeof this.nzSize?`${this.nzSize}px`:null,this.cdr.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](a.a),r["\u0275\u0275directiveInject"](r.ElementRef),r["\u0275\u0275directiveInject"](r.ChangeDetectorRef),r["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["nz-avatar"]],viewQuery:function(e,t){var n;1&e&&r["\u0275\u0275viewQuery"](u,!0),2&e&&r["\u0275\u0275queryRefresh"](n=r["\u0275\u0275loadQuery"]())&&(t.textEl=n.first)},hostVars:20,hostBindings:function(e,t){2&e&&(r["\u0275\u0275styleProp"]("width",t.customSize)("height",t.customSize)("line-height",t.customSize)("font-size",t.hasIcon&&t.customSize?t.nzSize/2:null,"px"),r["\u0275\u0275classProp"]("ant-avatar-lg","large"===t.nzSize)("ant-avatar-sm","small"===t.nzSize)("ant-avatar-square","square"===t.nzShape)("ant-avatar-circle","circle"===t.nzShape)("ant-avatar-icon",t.nzIcon)("ant-avatar-image",t.hasSrc))},inputs:{nzShape:"nzShape",nzSize:"nzSize",nzGap:"nzGap",nzText:"nzText",nzSrc:"nzSrc",nzSrcSet:"nzSrcSet",nzAlt:"nzAlt",nzIcon:"nzIcon"},outputs:{nzError:"nzError"},exportAs:["nzAvatar"],features:[r["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:3,consts:[["nz-icon","",3,"nzType",4,"ngIf"],[3,"src","error",4,"ngIf"],["class","ant-avatar-string",3,"ngStyle",4,"ngIf"],["nz-icon","",3,"nzType"],[3,"src","error"],[1,"ant-avatar-string",3,"ngStyle"],["textEl",""]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,m,1,1,"i",0),r["\u0275\u0275template"](1,h,1,3,"img",1),r["\u0275\u0275template"](2,p,3,2,"span",2)),2&e&&(r["\u0275\u0275property"]("ngIf",t.nzIcon&&t.hasIcon),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.nzSrc&&t.hasSrc),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.nzText&&t.hasText))},directives:[c.NgIf,d.a,c.NgStyle],encapsulation:2,changeDetection:0}),Object(i.a)([Object(a.b)(),Object(i.b)("design:type",String)],e.prototype,"nzShape",void 0),Object(i.a)([Object(a.b)(),Object(i.b)("design:type",Object)],e.prototype,"nzSize",void 0),Object(i.a)([Object(a.b)(),Object(s.b)(),Object(i.b)("design:type",Object)],e.prototype,"nzGap",void 0),e})(),v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["nz-avatar-group"]],hostAttrs:[1,"ant-avatar-group"],exportAs:["nzAvatarGroup"],ngContentSelectors:f,decls:1,vars:0,template:function(e,t){1&e&&(r["\u0275\u0275projectionDef"](),r["\u0275\u0275projection"](0))},encapsulation:2,changeDetection:0}),e})(),S=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[l.a,c.CommonModule,d.b,o.b]]}),e})()},deo1:function(e,t,n){"use strict";n.r(t);var i=n("TEn/"),o=n("tyNb"),r=n("ofXK"),a=n("3Pt+"),s=n("mrSG"),l=n("qXBG"),c=n("tAfe"),d=n("6/gD"),u=n("26ZW"),m=n("B7Rs"),h=n("AytR"),p=n("F1TJ"),f=n("LWQN"),g=n("OKzL"),v=n("fXoL"),S=n("e8h1");function y(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"span"),v["\u0275\u0275elementStart"](1,"ion-badge",19),v["\u0275\u0275text"](2),v["\u0275\u0275elementEnd"](),v["\u0275\u0275text"](3,"\xa0 "),v["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=v["\u0275\u0275nextContext"](2);v["\u0275\u0275advance"](1),v["\u0275\u0275propertyInterpolate"]("color",n.getRandomColor(e)),v["\u0275\u0275advance"](1),v["\u0275\u0275textInterpolate"](e.roleName)}}function b(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-chip",20),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](2).changeRole()})),v["\u0275\u0275namespaceSVG"](),v["\u0275\u0275elementStart"](1,"svg",21),v["\u0275\u0275element"](2,"use",22),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}function x(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-col",26),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](3).students()})),v["\u0275\u0275element"](1,"ion-icon",27),v["\u0275\u0275elementStart"](2,"ion-label"),v["\u0275\u0275elementStart"](3,"h3"),v["\u0275\u0275text"](4,"\u6211\u7684\u5b66\u751f"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}function z(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-col",28),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](3).timetable()})),v["\u0275\u0275element"](1,"ion-icon",29),v["\u0275\u0275elementStart"](2,"ion-label"),v["\u0275\u0275elementStart"](3,"h3"),v["\u0275\u0275text"](4,"\u6211\u7684\u8bfe\u8868"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}function I(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"ion-slides",23),v["\u0275\u0275elementStart"](1,"ion-slide"),v["\u0275\u0275elementStart"](2,"ion-grid"),v["\u0275\u0275elementStart"](3,"ion-row"),v["\u0275\u0275template"](4,x,5,0,"ion-col",24),v["\u0275\u0275template"](5,z,5,0,"ion-col",25),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){const e=v["\u0275\u0275nextContext"](2);v["\u0275\u0275advance"](4),v["\u0275\u0275property"]("ngIf",e.is_teacher),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!e.is_admin)}}function E(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-col",32),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](4).timetable()})),v["\u0275\u0275element"](1,"ion-icon",34),v["\u0275\u0275elementStart"](2,"div"),v["\u0275\u0275elementStart"](3,"ion-label"),v["\u0275\u0275elementStart"](4,"h3"),v["\u0275\u0275text"](5,"\u6211\u7684\u8bfe\u8868"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}function C(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-grid"),v["\u0275\u0275elementStart"](1,"ion-row"),v["\u0275\u0275template"](2,E,6,0,"ion-col",31),v["\u0275\u0275elementStart"](3,"ion-col",32),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](3).dormitory()})),v["\u0275\u0275element"](4,"ion-icon",33),v["\u0275\u0275elementStart"](5,"div"),v["\u0275\u0275elementStart"](6,"ion-label"),v["\u0275\u0275elementStart"](7,"h3"),v["\u0275\u0275text"](8,"\u6211\u7684\u4f4f\u5bbf"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"](3);v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",!e.is_admin)}}function j(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"ion-slides",23),v["\u0275\u0275elementStart"](1,"ion-slide"),v["\u0275\u0275template"](2,C,9,1,"ion-grid",30),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){const e=v["\u0275\u0275nextContext"](2);v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",e.is_student)}}const _=function(){return["/me/teacher-person-archives"]};function w(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"ion-item",17),v["\u0275\u0275element"](1,"ion-icon",35),v["\u0275\u0275elementStart"](2,"ion-label"),v["\u0275\u0275elementStart"](3,"h3"),v["\u0275\u0275text"](4,"\u53d1\u5c55\u6863\u6848"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&v["\u0275\u0275property"]("routerLink",v["\u0275\u0275pureFunction0"](1,_))}const O=function(){return["/me/teacher-person-info"]};function k(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"ion-item",17),v["\u0275\u0275element"](1,"ion-icon",36),v["\u0275\u0275elementStart"](2,"ion-label"),v["\u0275\u0275elementStart"](3,"h3"),v["\u0275\u0275text"](4,"\u4e2a\u4eba\u8d44\u6599"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&v["\u0275\u0275property"]("routerLink",v["\u0275\u0275pureFunction0"](1,O))}const T=function(){return["/me/student-person-info"]};function N(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"ion-item",17),v["\u0275\u0275element"](1,"ion-icon",36),v["\u0275\u0275elementStart"](2,"ion-label"),v["\u0275\u0275elementStart"](3,"h3"),v["\u0275\u0275text"](4,"\u4e2a\u4eba\u8d44\u6599"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&v["\u0275\u0275property"]("routerLink",v["\u0275\u0275pureFunction0"](1,T))}const R=function(){return["/me/user-profile"]},M=function(){return["/me/feedback"]};function P(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"ion-content",2),v["\u0275\u0275elementStart"](1,"ion-list",3),v["\u0275\u0275elementStart"](2,"ion-item",4),v["\u0275\u0275elementStart"](3,"ion-thumbnail",5),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().upload_avatar()})),v["\u0275\u0275element"](4,"img",6),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](5,"ion-label",7),v["\u0275\u0275text"](6),v["\u0275\u0275elementStart"](7,"span",8),v["\u0275\u0275text"](8),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](9,"p"),v["\u0275\u0275text"](10),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](11,"p",9),v["\u0275\u0275template"](12,y,4,2,"span",10),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](13,b,3,0,"ion-chip",11),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](14,I,6,2,"ion-slides",12),v["\u0275\u0275template"](15,j,3,1,"ion-slides",12),v["\u0275\u0275elementStart"](16,"ion-list",13),v["\u0275\u0275template"](17,w,5,2,"ion-item",14),v["\u0275\u0275template"](18,k,5,2,"ion-item",14),v["\u0275\u0275template"](19,N,5,2,"ion-item",14),v["\u0275\u0275elementStart"](20,"ion-item",15),v["\u0275\u0275listener"]("click",(function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().setting()})),v["\u0275\u0275element"](21,"ion-icon",16),v["\u0275\u0275elementStart"](22,"ion-label"),v["\u0275\u0275elementStart"](23,"h3"),v["\u0275\u0275text"](24,"\u8bbe\u7f6e"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275element"](25,"ion-list"),v["\u0275\u0275elementStart"](26,"ion-list",13),v["\u0275\u0275elementStart"](27,"ion-item",17),v["\u0275\u0275element"](28,"ion-icon",18),v["\u0275\u0275elementStart"](29,"ion-label"),v["\u0275\u0275elementStart"](30,"h3"),v["\u0275\u0275text"](31,"\u610f\u89c1\u53cd\u9988"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"]();v["\u0275\u0275property"]("fullscreen",!0),v["\u0275\u0275advance"](4),v["\u0275\u0275property"]("src",e.user.avatarUrl,v["\u0275\u0275sanitizeUrl"]),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("routerLink",v["\u0275\u0275pureFunction0"](14,R)),v["\u0275\u0275advance"](1),v["\u0275\u0275textInterpolate1"](" ",e.user.userName," \xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.user.accountName),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.user.schoolName),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngForOf",e.user.roles),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",e.showChangeRole),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!e.is_student),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",e.is_student),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",e.is_teacher),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",e.is_teacher),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",e.is_student),v["\u0275\u0275advance"](8),v["\u0275\u0275property"]("routerLink",v["\u0275\u0275pureFunction0"](15,M))}}let L=(()=>{class e{constructor(e,t,n,i,o,r,a,s,l,c,d,u,m,p){this.actionSheetController=e,this.authSrv=t,this.route=n,this.photosrv=i,this.imagePicker=o,this.toastController=r,this.orsv=a,this.storage=s,this.transfer=l,this.platform=c,this.loadingController=d,this.jpush=u,this.comm=m,this.routeActived=p,this.showChangeRole=!1,this.fileTransfer=this.transfer.create(),this.default_avatar=h.a.default_avatar,this.array_colors=["primary","secondary","tertiary","success","warning","danger"],this.role_color_object=[{RoleName:"\u7ba1\u7406\u5458",ColorName:"primary"},{RoleName:"\u6559\u5e08",ColorName:"secondary"},{RoleName:"\u5bfc\u5e08",ColorName:"tertiary"},{RoleName:"\u5bb6\u957f",ColorName:"success"},{RoleName:"\u5b66\u751f",ColorName:"warning"},{RoleName:"\u62db\u751f\u529e",ColorName:"danger"},{RoleName:"\u73ed\u957f",ColorName:"warning"},{RoleName:"\u6f14\u793a",ColorName:"secondary"}],this.storage.get("USER_INFO").then(e=>{this.showChangeRole=e.roles.length>1})}ionViewWillEnter(){this.routeActived.url.subscribe(e=>{this.init()})}init(){return Object(s.a)(this,void 0,void 0,(function*(){this.user=yield this.authSrv.get_user(),this.is_student=yield this.authSrv.is_student(),this.is_teacher=yield this.authSrv.is_teacher(),this.is_admin=yield this.authSrv.is_admin()}))}collection(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/collection"])}))}history(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/history"])}))}timetable(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/my-timetable"])}))}students(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/features/klasses"])}))}logout(){return Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.actionSheetController.create({buttons:[{text:"\u786e\u8ba4\u6ce8\u9500",icon:"log-out-outline",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){return yield this.authSrv.logout(),!0}))}]});yield e.present()}))}upload_avatar(){return Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.actionSheetController.create({header:"\u4e0a\u4f20\u5934\u50cf",buttons:[{text:"\u67e5\u770b\u5927\u56fe",icon:"search-outline",handler:()=>{this.comm.presentModal(g.a,"",{Images:[this.user.avatarUrl],index:0})}},{text:"\u62cd\u7167",icon:"camera-outline",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){if(yield this.photosrv.add_new(),!(this.photosrv.photo_info.length>0))return!1;var e=yield this.comm.loadingPresent(),t=this.photosrv.photo_info[0],n=yield this.orsv.upload_pic(t.base64,t.ext);return this.photosrv.photo_info=new Array,0==(yield this.orsv.upload_avatar({userid:this.user.userID,avatarUrl:n.url,modifiedBy:this.user.userName})).code&&(this.presentToast("\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01","success"),this.user.avatarUrl=n.url,this.storage.set("USER_INFO",this.user)),e.dismiss(),!0}))},{text:"\u4ece\u624b\u673a\u76f8\u518c\u9009\u62e9",icon:"image-outline",handler:()=>Object(s.a)(this,void 0,void 0,(function*(){return this.imagePicker.getPictures({maximumImagesCount:1,outputType:0,title:"\u9009\u62e9\u7167\u7247",message:"\u9009\u62e9\u56fe\u7247",quality:h.a.quality,width:h.a.image_width,height:h.a.image_height,disable_popover:!0}).then(e=>Object(s.a)(this,void 0,void 0,(function*(){if(0==e.length)return!1;{var t=e[0],n=yield this.authSrv.get_token();n="Bearer "+n;let i=yield this.presentLoading("\u52a0\u8f7d\u4e2d.........");return this.fileTransfer.upload(t,h.a.ym_endpoint+"/Utility/v1/Oss/Image/File",{httpMethod:"POST",headers:{path:h.a.oss_path,Authorization:n}}).then(e=>{if(i.dismiss(),200==e.responseCode){let t;t=JSON.parse(e.response),this.save_avatar(t.data.url,t.data.fileName)}else this.presentToast("\u4e0a\u4f20\u5934\u50cf\u5931\u8d25\uff01")}).catch(e=>{this.presentToast("\u66f4\u65b0\u5934\u50cf\u5931\u8d25\uff01"),i.dismiss()}),!0}}))),!0}))},{text:"\u5173\u95ed",icon:"close",role:"cancel",handler:()=>{}}]});yield e.present()}))}save_avatar(e,t){return Object(s.a)(this,void 0,void 0,(function*(){var t=yield this.orsv.upload_avatar({userid:this.user.userID,avatarUrl:e,modifiedBy:this.user.userName});if(0!=t.code)return this.presentToast(t.msg),!1;this.presentToast("\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01","success"),this.user.avatarUrl=e,this.storage.set("USER_INFO",this.user)}))}setting(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/system-setting"])}))}dormitory(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/my-bed",{studentId:this.user.userCode}])}))}presentToast(e,t="danger"){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:e,color:t,duration:2e3})).present()}))}presentLoading(e){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.loadingController.create({message:e,duration:0});return yield t.present(),t}))}feedback(){return Object(s.a)(this,void 0,void 0,(function*(){}))}getRandomColor(e){let t="primary",n=this.role_color_object.find(t=>e.roleName.indexOf(t.RoleName)>0||t.RoleName===e.roleName);return n&&(t=n.ColorName),t}changeRole(){return Object(s.a)(this,void 0,void 0,(function*(){this.route.navigate(["/me/change-role/",{}])}))}}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](i.ActionSheetController),v["\u0275\u0275directiveInject"](l.a),v["\u0275\u0275directiveInject"](o.g),v["\u0275\u0275directiveInject"](d.a),v["\u0275\u0275directiveInject"](c.a),v["\u0275\u0275directiveInject"](i.ToastController),v["\u0275\u0275directiveInject"](u.a),v["\u0275\u0275directiveInject"](S.b),v["\u0275\u0275directiveInject"](m.a),v["\u0275\u0275directiveInject"](i.Platform),v["\u0275\u0275directiveInject"](i.LoadingController),v["\u0275\u0275directiveInject"](p.a),v["\u0275\u0275directiveInject"](f.a),v["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-me"]],decls:5,vars:2,consts:[[3,"translucent"],["class","me_content",3,"fullscreen",4,"ngIf"],[1,"me_content",3,"fullscreen"],["lines","full"],["lines","full",2,"margin-bottom","10px"],["slot","start",1,"avatar",3,"click"],[1,"avatar-image",3,"src"],[3,"routerLink"],[2,"font-size","small","color","darkgrey"],[2,"margin-top","5px"],[4,"ngFor","ngForOf"],["slot","end","color","_","style","margin: 0;",3,"click",4,"ngIf"],["pager","false",4,"ngIf"],[2,"border-top","5px solid #f9f7f7"],["lines","none","button","",3,"routerLink",4,"ngIf"],["lines","none","button","",3,"click"],["slot","start","color","blue",1,"iconfont","ym-font","iconshezhi"],["lines","none","button","",3,"routerLink"],["slot","start","color","blue","name","chatbox-outline"],[2,"color","#ffffff",3,"color"],["slot","end","color","_",2,"margin","0",3,"click"],["aria-hidden","true",1,"icon",2,"width","5rem","height","5rem","margin","0 auto"],[0,"xlink","href","#iconqiehuanjiaose"],["pager","false"],["size","3","style","text-align: center;",3,"click",4,"ngIf"],["size","3","button","","style","text-align: center;",3,"click",4,"ngIf"],["size","3",2,"text-align","center",3,"click"],["color","blue",1,"iconfont","ym-font","iconxueshengi-active"],["size","3","button","",2,"text-align","center",3,"click"],["color","purple",1,"iconfont","ym-font","iconkebiao"],[4,"ngIf"],["size","3","button","","style","text-align: center;padding-top:9px",3,"click",4,"ngIf"],["size","3","button","",2,"text-align","center","padding-top","9px",3,"click"],["color","yellow",1,"iconfont","ym-fontsmail","iconwodezhusu"],["color","purple",1,"iconfont","ym-fontsmail","iconkebiao"],["slot","start","color","red",1,"iconfont","ym-font","iconjiaoxuepinggu-01"],["slot","start","color","green",1,"iconfont","ym-font","iconxueyuandangan-01"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"ion-header",0),v["\u0275\u0275elementStart"](1,"ion-toolbar"),v["\u0275\u0275elementStart"](2,"ion-title"),v["\u0275\u0275text"](3," \u6211 "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](4,P,32,16,"ion-content",1)),2&e&&(v["\u0275\u0275property"]("translucent",!0),v["\u0275\u0275advance"](4),v["\u0275\u0275property"]("ngIf",t.user))},directives:[i.IonHeader,i.IonToolbar,i.IonTitle,r.NgIf,i.IonContent,i.IonList,i.IonItem,i.IonThumbnail,i.IonLabel,i.RouterLinkDelegate,o.h,r.NgForOf,i.IonIcon,i.IonBadge,i.IonChip,i.IonSlides,i.IonSlide,i.IonGrid,i.IonRow,i.IonCol],styles:["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}ion-slides[_ngcontent-%COMP%]{background:#fff}.me_content[_ngcontent-%COMP%]{--background:#f9f7f7}.header-ios[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]:last-of-type{--border-width:0}.item[_ngcontent-%COMP%]{border-top:5px solid #f9f7f7}.icon[_ngcontent-%COMP%]{width:1.4rem;height:1.4rem;vertical-align:-.15em;fill:currentColor;overflow:hidden;margin-right:10px}"]}),e})();var A=n("qtYk"),V=n("Ql/B");n.d(t,"MePageModule",(function(){return F}));let F=(()=>{class e{}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.IonicModule,r.CommonModule,a.FormsModule,A.a,o.i.forChild([{path:"",component:L}]),V.a]]}),e})()}}]);