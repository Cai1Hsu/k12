(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{d7ZJ:function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),c=n("tyNb"),l=n("mrSG"),s=n("HQRm"),d=n("26ZW"),a=n("MCLT"),m=n("qXBG"),h=n("wd/R"),u=n("LWQN"),f=n("fXoL");function k(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u672a\u5f00\u59cb "),f["\u0275\u0275elementEnd"]())}function p(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u8fdb\u884c\u4e2d "),f["\u0275\u0275elementEnd"]())}function I(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u5df2\u7ed3\u675f "),f["\u0275\u0275elementEnd"]())}function b(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u5df2\u5173\u95ed "),f["\u0275\u0275elementEnd"]())}function g(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-col",4),f["\u0275\u0275elementStart"](1,"ion-item"),f["\u0275\u0275elementStart"](2,"ion-checkbox",5),f["\u0275\u0275listener"]("ngModelChange",(function(n){return f["\u0275\u0275restoreView"](e),t.$implicit.check=n}))("click",(function(){f["\u0275\u0275restoreView"](e);const n=t.$implicit;return f["\u0275\u0275nextContext"](2).checked(n.id)})),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=f["\u0275\u0275nextContext"](2);f["\u0275\u0275advance"](2),f["\u0275\u0275propertyInterpolate"]("disabled",e.disabled||"3"!=n.the_kemu.status),f["\u0275\u0275propertyInterpolate"]("value",e.id),f["\u0275\u0275property"]("ngModel",e.check),f["\u0275\u0275advance"](1),f["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function v(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"ion-list"),f["\u0275\u0275elementStart"](1,"ion-item"),f["\u0275\u0275elementStart"](2,"ion-label"),f["\u0275\u0275elementStart"](3,"h2"),f["\u0275\u0275text"](4),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](5,k,2,0,"h3",2),f["\u0275\u0275template"](6,p,2,0,"h3",2),f["\u0275\u0275template"](7,I,2,0,"h3",2),f["\u0275\u0275template"](8,b,2,0,"h3",2),f["\u0275\u0275elementStart"](9,"h3"),f["\u0275\u0275text"](10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](11,"ion-grid"),f["\u0275\u0275elementStart"](12,"ion-row"),f["\u0275\u0275template"](13,g,4,4,"ion-col",3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate1"](" ",e.the_kemu.name," "),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","2"==e.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","3"==e.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","4"==e.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","5"==e.the_kemu.status),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate2"](" ",e.the_kemu.startDateTime," / ",e.the_kemu.endDateTime," "),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngForOf",e.the_kemu.kemu)}}function x(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-button",8),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"](2).checkKemu()})),f["\u0275\u0275element"](1,"ion-icon",9),f["\u0275\u0275text"](2,"\u9009\u62e9 "),f["\u0275\u0275elementEnd"]()}}function E(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-button",10),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"](2).exit()})),f["\u0275\u0275element"](1,"ion-icon",11),f["\u0275\u0275text"](2,"\u91cd\u65b0\u9009\u62e9 "),f["\u0275\u0275elementEnd"]()}}function y(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"ion-footer"),f["\u0275\u0275elementStart"](1,"ion-row"),f["\u0275\u0275elementStart"](2,"ion-col"),f["\u0275\u0275template"](3,x,3,0,"ion-button",6),f["\u0275\u0275template"](4,E,3,0,"ion-button",7),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",!e.the_kemu.isCheck),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",e.the_kemu.isCheck)}}const _=[{path:"",component:(()=>{class e{constructor(e,t,n,o){this.route=e,this.osrv=t,this.auth=n,this.comm=o,this.checkedId=[],this.route.params.subscribe(e=>{this.taskId=e.id}),this.auth.get_user().then(e=>{this.user=e,this.load(this.taskId)})}ngOnInit(){}load(e){return Object(l.a)(this,void 0,void 0,(function*(){let t={id:e,studentid:this.user.userCode};var n=yield this.comm.loadingPresent();yield this.osrv.get_task(t).then(e=>{this.the_kemu=e.data,this.the_kemu.startDateTime=h(this.the_kemu.startDateTime).format("YYYY-MM-DD HH:mm:ss"),this.the_kemu.endDateTime=h(this.the_kemu.endDateTime).format("YYYY-MM-DD HH:mm:ss"),this.the_kemu.kemu.forEach(e=>{e.disabled=!1});let t=this.the_kemu.kemu,n=this.the_kemu.combo;t.forEach(e=>{e.check&&this.checkedId.push(e.id)});let o=[];n.forEach(e=>{let t=e.combo;if(0==this.checkedId.length)o.push(t);else{let e=!0;this.checkedId.forEach(n=>{null==t.find(e=>e.id==n)&&(e=!1)}),e&&o.push(t)}}),t.forEach(e=>{e.disabled=!0,o.forEach(t=>{null!=t.find(t=>t.id==e.id)&&(e.disabled=!1)})}),3==this.checkedId.length&&this.the_kemu.kemu.forEach(e=>{e.disabled=!0})}),n.dismiss()}))}checked(e){return Object(l.a)(this,void 0,void 0,(function*(){let t=this.the_kemu.kemu,n=this.the_kemu.combo;if(null!=this.checkedId.find(t=>t==e))this.del(this.checkedId,e);else{if(3==this.checkedId.length)return yield this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u79d1\u76ee\u6700\u5927\u53ea\u80fd\u9009\u62e93\u4e2a",["\u786e\u5b9a"]),!1;this.checkedId.push(e)}let o=[];n.forEach(e=>{let t=e.combo;if(0==this.checkedId.length)o.push(t);else{let e=!0;this.checkedId.forEach(n=>{null==t.find(e=>e.id==n)&&(e=!1)}),e&&o.push(t)}}),t.forEach(e=>{e.disabled=!0,o.forEach(t=>{null!=t.find(t=>t.id==e.id)&&(e.disabled=!1)})})}))}del(e,t){return Object(l.a)(this,void 0,void 0,(function*(){const n=e.indexOf(t);return e=e.splice(n,1)}))}checkKemu(){return Object(l.a)(this,void 0,void 0,(function*(){if(this.checkedId.length<3)return yield this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u79d1\u76ee\u6700\u5927\u53ea\u80fd\u9009\u62e93\u4e2a",["\u786e\u5b9a"]),!1;let e="";if(this.the_kemu.combo.forEach(t=>{let n=t.combo,o=!0;this.checkedId.forEach(e=>{null==n.find(t=>t.id==e)&&(o=!1)}),o&&(t.combo.forEach(t=>{e+="+"+t.id}),e=e.substring(1))}),Object(a.isNull)(e)||""==e)return yield this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u672a\u627e\u5230\u9009\u62e9\u7684\u79d1\u76ee\u7ec4\u5408",["\u786e\u5b9a"]),!1;var t=new s.a;t.userCode=this.user.userCode,t.taskId=this.taskId,t.comboId=e,yield this.comm.presentAlertConfirm("\u6e29\u99a8\u63d0\u793a","\u662f\u5426\u786e\u5b9a\u9009\u62e9\u5f53\u524d\u7ec4\u5408",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",handler:()=>{this.osrv.choose(t).then(e=>Object(l.a)(this,void 0,void 0,(function*(){0==e.code?(this.comm.presentToast("\u9009\u62e9\u6210\u529f"),setTimeout(()=>{this.checkedId=[],this.load(this.taskId)},200)):this.comm.presentToast(e.msg)})))}}])}))}exit(){return Object(l.a)(this,void 0,void 0,(function*(){var e=new s.a;e.userCode=this.user.userCode,e.taskId=this.taskId,e.comboId="",this.the_kemu.combo.forEach(t=>{let n=t.combo.filter(e=>e.check);null!=n&&3==n.length&&n.forEach(t=>{e.comboId+="+"+t.id})}),e.comboId=e.comboId.substring(1),this.comm.presentAlertConfirm("\u6e29\u99a8\u63d0\u793a","\u662f\u5426\u786e\u5b9a\u9000\u9009\u5f53\u524d\u7ec4\u5408",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",handler:()=>{this.osrv.exit(e).then(e=>Object(l.a)(this,void 0,void 0,(function*(){0==e.code&&(this.comm.presentToast("\u9000\u9009\u6210\u529f,\u8bf7\u91cd\u65b0\u9009\u62e9"),setTimeout(()=>{this.checkedId=[],this.load(this.taskId)},200))})))}}])}))}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](c.a),f["\u0275\u0275directiveInject"](d.a),f["\u0275\u0275directiveInject"](m.a),f["\u0275\u0275directiveInject"](u.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["app-student-select-kumu"]],decls:9,vars:2,consts:[["slot","start"],["defaultHref","tabs"],[4,"ngIf"],["style","text-align: center;","size","4",4,"ngFor","ngForOf"],["size","4",2,"text-align","center"],["color","primary","slot","start",3,"disabled","ngModel","value","ngModelChange","click"],["color","primary","expand","block",3,"click",4,"ngIf"],["color","danger","expand","block",3,"click",4,"ngIf"],["color","primary","expand","block",3,"click"],["name","checkmark-circle-outline"],["color","danger","expand","block",3,"click"],["name","backspace-outline"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"ion-header"),f["\u0275\u0275elementStart"](1,"ion-toolbar"),f["\u0275\u0275elementStart"](2,"ion-buttons",0),f["\u0275\u0275element"](3,"ion-back-button",1),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"ion-title"),f["\u0275\u0275text"](5,"\u5b66\u751f\u9009\u79d1"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](6,"ion-content"),f["\u0275\u0275template"](7,v,14,8,"ion-list",2),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](8,y,5,2,"ion-footer",2)),2&e&&(f["\u0275\u0275advance"](7),f["\u0275\u0275property"]("ngIf",null!=t.the_kemu),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",null!=t.the_kemu&&"3"==t.the_kemu.status))},directives:[r.IonHeader,r.IonToolbar,r.IonButtons,r.IonBackButton,r.IonBackButtonDelegate,r.IonTitle,r.IonContent,o.NgIf,r.IonList,r.IonItem,r.IonLabel,r.IonGrid,r.IonRow,o.NgForOf,r.IonCol,r.IonCheckbox,r.BooleanValueAccessor,i.NgControlStatus,i.NgModel,r.IonFooter,r.IonButton,r.IonIcon],styles:[""]}),e})()}];let C=(()=>{class e{}return e.\u0275mod=f["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[c.i.forChild(_)],c.i]}),e})();n.d(t,"StudentSelectKumuPageModule",(function(){return S}));let S=(()=>{class e{}return e.\u0275mod=f["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.CommonModule,i.FormsModule,r.IonicModule,C]]}),e})()}}]);