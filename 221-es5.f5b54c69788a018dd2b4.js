function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{d7ZJ:function(e,t,n){"use strict";n.r(t);var r=n("ofXK"),o=n("3Pt+"),i=n("TEn/"),c=n("tyNb"),a=n("mrSG"),u=n("HQRm"),s=n("26ZW"),l=n("MCLT"),d=n("qXBG"),m=n("wd/R"),h=n("LWQN"),f=n("fXoL");function p(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u672a\u5f00\u59cb "),f["\u0275\u0275elementEnd"]())}function k(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u8fdb\u884c\u4e2d "),f["\u0275\u0275elementEnd"]())}function v(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u5df2\u7ed3\u675f "),f["\u0275\u0275elementEnd"]())}function I(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"h3"),f["\u0275\u0275text"](1," \u5df2\u5173\u95ed "),f["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-col",4),f["\u0275\u0275elementStart"](1,"ion-item"),f["\u0275\u0275elementStart"](2,"ion-checkbox",5),f["\u0275\u0275listener"]("ngModelChange",(function(e){return f["\u0275\u0275restoreView"](n),t.$implicit.check=e}))("click",(function(){f["\u0275\u0275restoreView"](n);var e=t.$implicit;return f["\u0275\u0275nextContext"](2).checked(e.id)})),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,o=f["\u0275\u0275nextContext"](2);f["\u0275\u0275advance"](2),f["\u0275\u0275propertyInterpolate"]("disabled",r.disabled||"3"!=o.the_kemu.status),f["\u0275\u0275propertyInterpolate"]("value",r.id),f["\u0275\u0275property"]("ngModel",r.check),f["\u0275\u0275advance"](1),f["\u0275\u0275textInterpolate1"](" ",r.name," ")}}function g(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"ion-list"),f["\u0275\u0275elementStart"](1,"ion-item"),f["\u0275\u0275elementStart"](2,"ion-label"),f["\u0275\u0275elementStart"](3,"h2"),f["\u0275\u0275text"](4),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](5,p,2,0,"h3",2),f["\u0275\u0275template"](6,k,2,0,"h3",2),f["\u0275\u0275template"](7,v,2,0,"h3",2),f["\u0275\u0275template"](8,I,2,0,"h3",2),f["\u0275\u0275elementStart"](9,"h3"),f["\u0275\u0275text"](10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](11,"ion-grid"),f["\u0275\u0275elementStart"](12,"ion-row"),f["\u0275\u0275template"](13,b,4,4,"ion-col",3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){var n=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate1"](" ",n.the_kemu.name," "),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","2"==n.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","3"==n.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","4"==n.the_kemu.status),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf","5"==n.the_kemu.status),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate2"](" ",n.the_kemu.startDateTime," / ",n.the_kemu.endDateTime," "),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngForOf",n.the_kemu.kemu)}}function x(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-button",8),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](n),f["\u0275\u0275nextContext"](2).checkKemu()})),f["\u0275\u0275element"](1,"ion-icon",9),f["\u0275\u0275text"](2,"\u9009\u62e9 "),f["\u0275\u0275elementEnd"]()}}function E(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-button",10),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](n),f["\u0275\u0275nextContext"](2).exit()})),f["\u0275\u0275element"](1,"ion-icon",11),f["\u0275\u0275text"](2,"\u91cd\u65b0\u9009\u62e9 "),f["\u0275\u0275elementEnd"]()}}function w(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"ion-footer"),f["\u0275\u0275elementStart"](1,"ion-row"),f["\u0275\u0275elementStart"](2,"ion-col"),f["\u0275\u0275template"](3,x,3,0,"ion-button",6),f["\u0275\u0275template"](4,E,3,0,"ion-button",7),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()),2&e){var n=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",!n.the_kemu.isCheck),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",n.the_kemu.isCheck)}}var C,_,y=[{path:"",component:(C=function(){function e(t,n,r,o){var i=this;_classCallCheck(this,e),this.route=t,this.osrv=n,this.auth=r,this.comm=o,this.checkedId=[],this.route.params.subscribe((function(e){i.taskId=e.id})),this.auth.get_user().then((function(e){i.user=e,i.load(i.taskId)}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"load",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:e,studentid:this.user.userCode},t.next=3,this.comm.loadingPresent();case 3:return r=t.sent,t.next=6,this.osrv.get_task(n).then((function(e){o.the_kemu=e.data,o.the_kemu.startDateTime=m(o.the_kemu.startDateTime).format("YYYY-MM-DD HH:mm:ss"),o.the_kemu.endDateTime=m(o.the_kemu.endDateTime).format("YYYY-MM-DD HH:mm:ss"),o.the_kemu.kemu.forEach((function(e){e.disabled=!1}));var t=o.the_kemu.kemu,n=o.the_kemu.combo;t.forEach((function(e){e.check&&o.checkedId.push(e.id)}));var r=[];n.forEach((function(e){var t=e.combo;if(0==o.checkedId.length)r.push(t);else{var n=!0;o.checkedId.forEach((function(e){null==t.find((function(t){return t.id==e}))&&(n=!1)})),n&&r.push(t)}})),t.forEach((function(e){e.disabled=!0,r.forEach((function(t){null!=t.find((function(t){return t.id==e.id}))&&(e.disabled=!1)}))})),3==o.checkedId.length&&o.the_kemu.kemu.forEach((function(e){e.disabled=!0}))}));case 6:r.dismiss();case 7:case"end":return t.stop()}}),t,this)})))}},{key:"checked",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.the_kemu.kemu,r=this.the_kemu.combo,null==this.checkedId.find((function(t){return t==e}))){t.next=5;break}this.del(this.checkedId,e),t.next=10;break;case 5:if(3!=this.checkedId.length){t.next=9;break}return t.next=8,this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u79d1\u76ee\u6700\u5927\u53ea\u80fd\u9009\u62e93\u4e2a",["\u786e\u5b9a"]);case 8:return t.abrupt("return",!1);case 9:this.checkedId.push(e);case 10:o=[],r.forEach((function(e){var t=e.combo;if(0==i.checkedId.length)o.push(t);else{var n=!0;i.checkedId.forEach((function(e){null==t.find((function(t){return t.id==e}))&&(n=!1)})),n&&o.push(t)}})),n.forEach((function(e){e.disabled=!0,o.forEach((function(t){null!=t.find((function(t){return t.id==e.id}))&&(e.disabled=!1)}))}));case 12:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e,t){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.indexOf(t),n.abrupt("return",e=e.splice(r,1));case 2:case"end":return n.stop()}}),n)})))}},{key:"checkKemu",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.checkedId.length<3)){e.next=4;break}return e.next=3,this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u79d1\u76ee\u6700\u5927\u53ea\u80fd\u9009\u62e93\u4e2a",["\u786e\u5b9a"]);case 3:return e.abrupt("return",!1);case 4:if(t="",this.the_kemu.combo.forEach((function(e){var n=e.combo,o=!0;r.checkedId.forEach((function(e){null==n.find((function(t){return t.id==e}))&&(o=!1)})),o&&(e.combo.forEach((function(e){t+="+"+e.id})),t=t.substring(1))})),!Object(l.isNull)(t)&&""!=t){e.next=9;break}return e.next=8,this.comm.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u672a\u627e\u5230\u9009\u62e9\u7684\u79d1\u76ee\u7ec4\u5408",["\u786e\u5b9a"]);case 8:return e.abrupt("return",!1);case 9:return(n=new u.a).userCode=this.user.userCode,n.taskId=this.taskId,n.comboId=t,e.next=15,this.comm.presentAlertConfirm("\u6e29\u99a8\u63d0\u793a","\u662f\u5426\u786e\u5b9a\u9009\u62e9\u5f53\u524d\u7ec4\u5408",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",handler:function(){r.osrv.choose(n).then((function(e){return Object(a.a)(r,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.code?(this.comm.presentToast("\u9009\u62e9\u6210\u529f"),setTimeout((function(){n.checkedId=[],n.load(n.taskId)}),200)):this.comm.presentToast(e.msg);case 1:case"end":return t.stop()}}),t,this)})))}))}}]);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"exit",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new u.a).userCode=this.user.userCode,t.taskId=this.taskId,t.comboId="",this.the_kemu.combo.forEach((function(e){var n=e.combo.filter((function(e){return e.check}));null!=n&&3==n.length&&n.forEach((function(e){t.comboId+="+"+e.id}))})),t.comboId=t.comboId.substring(1),this.comm.presentAlertConfirm("\u6e29\u99a8\u63d0\u793a","\u662f\u5426\u786e\u5b9a\u9000\u9009\u5f53\u524d\u7ec4\u5408",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",handler:function(){n.osrv.exit(t).then((function(e){return Object(a.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.code&&(this.comm.presentToast("\u9000\u9009\u6210\u529f,\u8bf7\u91cd\u65b0\u9009\u62e9"),setTimeout((function(){n.checkedId=[],n.load(n.taskId)}),200));case 1:case"end":return t.stop()}}),t,this)})))}))}}]);case 2:case"end":return e.stop()}}),e,this)})))}}]),e}(),C.\u0275fac=function(e){return new(e||C)(f["\u0275\u0275directiveInject"](c.a),f["\u0275\u0275directiveInject"](s.a),f["\u0275\u0275directiveInject"](d.a),f["\u0275\u0275directiveInject"](h.a))},C.\u0275cmp=f["\u0275\u0275defineComponent"]({type:C,selectors:[["app-student-select-kumu"]],decls:9,vars:2,consts:[["slot","start"],["defaultHref","tabs"],[4,"ngIf"],["style","text-align: center;","size","4",4,"ngFor","ngForOf"],["size","4",2,"text-align","center"],["color","primary","slot","start",3,"disabled","ngModel","value","ngModelChange","click"],["color","primary","expand","block",3,"click",4,"ngIf"],["color","danger","expand","block",3,"click",4,"ngIf"],["color","primary","expand","block",3,"click"],["name","checkmark-circle-outline"],["color","danger","expand","block",3,"click"],["name","backspace-outline"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"ion-header"),f["\u0275\u0275elementStart"](1,"ion-toolbar"),f["\u0275\u0275elementStart"](2,"ion-buttons",0),f["\u0275\u0275element"](3,"ion-back-button",1),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"ion-title"),f["\u0275\u0275text"](5,"\u5b66\u751f\u9009\u79d1"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](6,"ion-content"),f["\u0275\u0275template"](7,g,14,8,"ion-list",2),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](8,w,5,2,"ion-footer",2)),2&e&&(f["\u0275\u0275advance"](7),f["\u0275\u0275property"]("ngIf",null!=t.the_kemu),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",null!=t.the_kemu&&"3"==t.the_kemu.status))},directives:[i.IonHeader,i.IonToolbar,i.IonButtons,i.IonBackButton,i.IonBackButtonDelegate,i.IonTitle,i.IonContent,r.NgIf,i.IonList,i.IonItem,i.IonLabel,i.IonGrid,i.IonRow,r.NgForOf,i.IonCol,i.IonCheckbox,i.BooleanValueAccessor,o.NgControlStatus,o.NgModel,i.IonFooter,i.IonButton,i.IonIcon],styles:[""]}),C)}],S=((_=function e(){_classCallCheck(this,e)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:_}),_.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||_)},imports:[[c.i.forChild(y)],c.i]}),_);n.d(t,"StudentSelectKumuPageModule",(function(){return R}));var j,R=((j=function e(){_classCallCheck(this,e)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:j}),j.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||j)},imports:[[r.CommonModule,o.FormsModule,i.IonicModule,S]]}),j)}}]);