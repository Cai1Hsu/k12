(window.webpackJsonp=window.webpackJsonp||[]).push([[217],{GAGe:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("3Pt+"),s=n("TEn/"),r=n("tyNb"),a=n("mrSG"),l=n("26ZW"),c=n("qXBG"),d=n("wd/R"),m=n("LWQN"),h=n("cM7C"),u=n("VWz1"),p=n("D+jN"),_=n("fXoL");function f(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-toolbar"),_["\u0275\u0275elementStart"](1,"ion-list"),_["\u0275\u0275elementStart"](2,"ion-item"),_["\u0275\u0275elementStart"](3,"ion-label"),_["\u0275\u0275elementStart"](4,"h3"),_["\u0275\u0275text"](5),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](6,"p"),_["\u0275\u0275text"](7),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](8,"P"),_["\u0275\u0275text"](9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"]();_["\u0275\u0275advance"](5),_["\u0275\u0275textInterpolate1"](" ",e.the_record.name," "),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate2"](" ",e.the_record.status," / ",e.the_record.taskTag," "),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate2"]("",e.the_record.startDateTime,"\u81f3",e.the_record.endDateTime,"")}}function g(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"ion-item-divider",6),_["\u0275\u0275elementStart"](1,"h6"),_["\u0275\u0275text"](2,"\u5df2\u9009\u6559\u5b66\u73ed"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]())}function v(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-label",11),_["\u0275\u0275text"](1),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"]().$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275textInterpolate2"]("",e.num_actual," / ",e.num," ")}}function Y(e,t){1&e&&_["\u0275\u0275element"](0,"ion-label",11)}function I(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"p"),_["\u0275\u0275text"](1," \u9000 "),_["\u0275\u0275elementEnd"]())}function b(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"p"),_["\u0275\u0275text"](1," \u9009 "),_["\u0275\u0275elementEnd"]())}function y(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-button",12),_["\u0275\u0275elementStart"](1,"ion-label"),_["\u0275\u0275template"](2,I,2,0,"p",2),_["\u0275\u0275template"](3,b,2,0,"p",2),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"]().$implicit;_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("ngIf",e.is_choose),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",!e.is_choose)}}function x(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"ion-item",8),_["\u0275\u0275listener"]("click",(function(){_["\u0275\u0275restoreView"](e);const n=t.$implicit,i=_["\u0275\u0275nextContext"](3);return i.the_record.is_allot_choose?i.change_tab(n):""})),_["\u0275\u0275elementStart"](1,"ion-label"),_["\u0275\u0275elementStart"](2,"h3"),_["\u0275\u0275text"](3),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](4,"ion-label"),_["\u0275\u0275elementStart"](5,"h3"),_["\u0275\u0275text"](6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](7,"ion-label"),_["\u0275\u0275elementStart"](8,"h3"),_["\u0275\u0275text"](9),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](10,v,2,2,"ion-label",9),_["\u0275\u0275template"](11,Y,1,0,"ion-label",9),_["\u0275\u0275template"](12,y,4,2,"ion-button",10),_["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=_["\u0275\u0275nextContext"](3);_["\u0275\u0275advance"](3),_["\u0275\u0275textInterpolate1"](" ",e.name," "),_["\u0275\u0275advance"](3),_["\u0275\u0275textInterpolate1"]("",e.tag," "),_["\u0275\u0275advance"](3),_["\u0275\u0275textInterpolate"](e.is_choose?e.teacher_name:""),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",e.is_choose),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",!e.is_choose),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",n.the_record.is_allot_choose)}}function D(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-item-group"),_["\u0275\u0275template"](1,x,13,6,"ion-item",7),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.the_student_course)}}function S(e,t){if(1&e){const e=_["\u0275\u0275getCurrentView"]();_["\u0275\u0275elementStart"](0,"ion-button",20),_["\u0275\u0275listener"]("click",(function(){_["\u0275\u0275restoreView"](e);const t=_["\u0275\u0275nextContext"]().$implicit,n=_["\u0275\u0275nextContext"]().$implicit,i=_["\u0275\u0275nextContext"](3);return t.is_allot_choose&&i.the_record.is_allot_choose?i.open(t,n):""})),_["\u0275\u0275elementStart"](1,"ion-label"),_["\u0275\u0275elementStart"](2,"p"),_["\u0275\u0275text"](3," \u9009TA "),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()}}function E(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-item",16),_["\u0275\u0275elementStart"](1,"ion-grid"),_["\u0275\u0275elementStart"](2,"ion-row"),_["\u0275\u0275elementStart"](3,"ion-col",17),_["\u0275\u0275elementStart"](4,"ion-label"),_["\u0275\u0275elementStart"](5,"h3"),_["\u0275\u0275text"](6),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](7,"p"),_["\u0275\u0275text"](8),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](9,"ion-col"),_["\u0275\u0275elementStart"](10,"ion-label",11),_["\u0275\u0275text"](11),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](12,"ion-col",18),_["\u0275\u0275template"](13,S,4,0,"ion-button",19),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=_["\u0275\u0275nextContext"](4);_["\u0275\u0275property"]("color",e.is_allot_choose?"":"light"),_["\u0275\u0275advance"](6),_["\u0275\u0275textInterpolate1"](" ",e.name," "),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate1"](" ",e.teacher_name," "),_["\u0275\u0275advance"](3),_["\u0275\u0275textInterpolate2"](" ",e.num_actual," / ",e.num," "),_["\u0275\u0275advance"](2),_["\u0275\u0275property"]("ngIf",e.is_allot_choose&&n.the_record.is_allot_choose)}}function M(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-item-group"),_["\u0275\u0275elementStart"](1,"ion-item-divider",14),_["\u0275\u0275elementStart"](2,"h6"),_["\u0275\u0275text"](3),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](4,E,14,6,"ion-item",15),_["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;_["\u0275\u0275advance"](1),_["\u0275\u0275propertyInterpolate1"]("id","course_group_",e.course_id,""),_["\u0275\u0275advance"](2),_["\u0275\u0275textInterpolate1"]("",e.course_name," "),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.teachclasses)}}function H(e,t){if(1&e&&(_["\u0275\u0275elementContainerStart"](0),_["\u0275\u0275template"](1,M,5,3,"ion-item-group",13),_["\u0275\u0275elementContainerEnd"]()),2&e){const e=_["\u0275\u0275nextContext"](2);_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngForOf",e.the_record.course)}}function w(e,t){if(1&e&&(_["\u0275\u0275elementStart"](0,"ion-list"),_["\u0275\u0275template"](1,g,3,0,"ion-item-divider",5),_["\u0275\u0275template"](2,D,2,1,"ion-item-group",2),_["\u0275\u0275template"](3,H,2,1,"ng-container",2),_["\u0275\u0275elementEnd"]()),2&e){const e=_["\u0275\u0275nextContext"]();_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",e.the_student_course),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",e.the_student_course),_["\u0275\u0275advance"](1),_["\u0275\u0275property"]("ngIf",!0===e.show_list)}}const T=[{path:"",component:(()=>{class e{constructor(e,t,n,i,o,s,r,a){this.osrv=e,this.route=t,this.router=n,this.auth=i,this.comm=o,this.platform=s,this.powerManagement=r,this.cache=a,this.the_times=0,this.the_times_all=0,this.show_list=!1,this.log_list=[],t.paramMap.subscribe(e=>{this.taskId=e.get("id")}),this.powerManagement.setReleaseOnPause(!1),this.powerManagement.acquire().then(()=>{}).catch(e=>{})}ngOnInit(){try{this.load(),this.pauseSubscribe=this.platform.pause.subscribe(()=>{this.timer&&clearInterval(this.timer),this.modal&&this.modal.dismiss({close:!0},"cancel"),this.powerManagement.release().then(()=>{}).catch(e=>{})}),this.resumeSubscribe=this.platform.resume.subscribe(()=>{this.powerManagement.acquire().then(()=>{}).catch(e=>{}),document.getElementById("btnReLoad").click()})}catch(e){}}reload(){return Object(a.a)(this,void 0,void 0,(function*(){yield this.load()}))}load(){return Object(a.a)(this,void 0,void 0,(function*(){try{this.show_list=!1,this.user=yield this.auth.get_user(),this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1a\u52a0\u8f7d\u6570\u636e"),yield this.loadData(),this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1a\u8bbe\u7f6e\u5012\u8ba1\u65f6"),yield this.inval(),this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1a\u521d\u59cb\u5316\u6570\u636e"),yield this.init()}catch(e){this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload exception \uff1a"+JSON.stringify(e))}}))}loadData(){return Object(a.a)(this,void 0,void 0,(function*(){try{this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload data step 1"),this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload data step 2");var e=yield this.osrv.get_select_course_detail(this.taskId,this.user);0!=e.code&&this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload data error :"+e.msg),this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload data step 3"),this.the_record=e.data,this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1a\u83b7\u53d6record success"),this.the_record.startDateTime=d(this.the_record.startDateTime).format("YYYY-MM-DD HH:mm:ss"),this.the_record.endDateTime=d(this.the_record.endDateTime).format("YYYY-MM-DD HH:mm:ss")}catch(t){this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aload data exception \uff1a"+JSON.stringify(t))}}))}init(){var e;return Object(a.a)(this,void 0,void 0,(function*(){let t,n=new Date,i=d(n)>d(this.the_record.startDateTime),o=d(n)<d(this.the_record.endDateTime);if(i&&o?this.the_record.status="\u8fdb\u884c\u4e2d":o||(this.the_record.status="\u5df2\u7ed3\u675f"),this.the_student_course=[],this.the_student_course=yield this.osrv.get_select_course_course(this.taskId,this.user),this.the_student_course){let e=[];t=this.the_student_course.filter(e=>e.is_choose),t&&t.forEach(t=>{e.indexOf(t.id)<0&&e.push(t.id)}),this.the_student_course.filter(e=>!e.is_choose).forEach(n=>{e.indexOf(n.id)<0&&null==t.find(e=>e.id==n.id)&&t.push(n)}),this.the_student_course=t}this.the_record.course=null===(e=this.the_record.course)||void 0===e?void 0:e.filter(e=>e.teachclasses.length>0)}))}inval(){return Object(a.a)(this,void 0,void 0,(function*(){let e,t;if(this.server_date=(yield this.osrv.get_date()).data,this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1aserver date :"+d(this.server_date).format("YYYY-MM-DD HH:mm:ss")),this.the_record.times&&this.the_record.times.length>0){var n=this.the_record.times.find(e=>d(this.server_date).isBetween(d(e.planStartTime).format("YYYY-MM-DD HH:mm:ss"),d(e.planEndTime).format("YYYY-MM-DD HH:mm:ss"),"seconds"));if(null!=n)e=n.planStartTime,t=n.planEndTime;else{let n=this.the_record.times.filter(e=>d(this.server_date).isBefore(d(e.planStartTime).format("YYYY-MM-DD HH:mm:ss"),"seconds"));n.length>0?(e=n[0].planStartTime,t=n[0].planEndTime):(t=this.the_record.endDateTime,e=this.the_record.startDateTime)}}else t=this.the_record.endDateTime,e=this.the_record.startDateTime;this.the_times=d(e).diff(d(this.server_date),"seconds"),this.the_times_all=this.the_times,this.the_times>1?(this.modal=yield this.comm.presentModal(h.a,"count-down-model-css",{Total:this.the_times_all,Times:this.the_times}),yield this.modal.onDidDismiss().then(e=>{try{if(!e.data||0==e.data.flag)return void history.back();if(1==e.data.close)return;this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1a\u5f00\u59cb\u5237\u65b0"),document.getElementById("btnReLoad").click()}catch(t){this.log_list.push(d().format("YYYY-MM-DD HH:mm:ss")+"\uff1areload exception \uff1a"+JSON.stringify(t))}}),this.show_list=!1):(this.the_times=d(t).diff(d(this.server_date),"seconds"),this.the_times>1&&(this.timer=setInterval(()=>{this.the_times<=1?(clearInterval(this.timer),document.getElementById("btnReLoad").click()):this.the_times--},1e3)),this.show_list=!0)}))}ionViewWillLeave(){this.timer&&clearInterval(this.timer),this.pauseSubscribe.unsubscribe(),this.resumeSubscribe.unsubscribe(),this.powerManagement.release().then(()=>{}).catch(e=>{})}change_tab(e){return Object(a.a)(this,void 0,void 0,(function*(){e.is_choose?yield this.comm.presentAlertConfirm("\u6e29\u99a8\u63d0\u793a","\u4f60\u786e\u5b9a\u8981\u9000\u9009\u8be5\u6559\u5b66\u73ed\u5417\uff1f",[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary",handler:e=>{}},{text:"\u786e\u5b9a",handler:()=>Object(a.a)(this,void 0,void 0,(function*(){var t=yield this.comm.loadingPresent();this.osrv.student_refound_course(e.teachclass_id,this.taskId,this.user.userCode).then(e=>Object(a.a)(this,void 0,void 0,(function*(){t.dismiss(),"0"==e.code?(yield this.comm.presentToast("\u9000\u9009\u6210\u529f"),setTimeout(()=>Object(a.a)(this,void 0,void 0,(function*(){yield this.loadData(),yield this.init()})),500)):yield this.comm.presentToast(e.msg)})))}))}]):document.getElementById("course_group_"+e.id).scrollIntoView()}))}open(e,t){return Object(a.a)(this,void 0,void 0,(function*(){var t=yield this.comm.loadingPresent();yield this.osrv.seelct_course(e.id,this.taskId,(yield this.auth.get_user()).userCode).then(e=>Object(a.a)(this,void 0,void 0,(function*(){t.dismiss(),"0"==e.code?(yield this.comm.presentToast("\u9009\u62e9\u6210\u529f"),setTimeout(()=>Object(a.a)(this,void 0,void 0,(function*(){yield this.loadData(),yield this.init()})),500)):yield this.comm.presentToast(e.msg)})))}))}}return e.\u0275fac=function(t){return new(t||e)(_["\u0275\u0275directiveInject"](l.a),_["\u0275\u0275directiveInject"](r.a),_["\u0275\u0275directiveInject"](r.g),_["\u0275\u0275directiveInject"](c.a),_["\u0275\u0275directiveInject"](m.a),_["\u0275\u0275directiveInject"](s.Platform),_["\u0275\u0275directiveInject"](u.a),_["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=_["\u0275\u0275defineComponent"]({type:e,selectors:[["app-student-select"]],decls:10,vars:2,consts:[["slot","start"],["defaultHref","tabs"],[4,"ngIf"],["overflow-scroll","true"],["id","btnReLoad",2,"display","none",3,"click"],["id","course_group",4,"ngIf"],["id","course_group"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["style","font-size: small;","color","primary",4,"ngIf"],["size","small","color","danger",4,"ngIf"],["color","primary",2,"font-size","small"],["size","small","color","danger"],[4,"ngFor","ngForOf"],[3,"id"],["button","",3,"color",4,"ngFor","ngForOf"],["button","",3,"color"],[2,"text-align","left"],[2,"text-align","right"],["color","light",3,"click",4,"ngIf"],["color","light",3,"click"]],template:function(e,t){1&e&&(_["\u0275\u0275elementStart"](0,"ion-header"),_["\u0275\u0275elementStart"](1,"ion-toolbar"),_["\u0275\u0275elementStart"](2,"ion-buttons",0),_["\u0275\u0275element"](3,"ion-back-button",1),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementStart"](4,"ion-title"),_["\u0275\u0275text"](5,"\u5b66\u751f\u9009\u8bfe"),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](6,f,10,5,"ion-toolbar",2),_["\u0275\u0275elementStart"](7,"ion-content",3),_["\u0275\u0275elementStart"](8,"a",4),_["\u0275\u0275listener"]("click",(function(){return t.reload()})),_["\u0275\u0275elementEnd"](),_["\u0275\u0275template"](9,w,4,3,"ion-list",2),_["\u0275\u0275elementEnd"]()),2&e&&(_["\u0275\u0275advance"](6),_["\u0275\u0275property"]("ngIf",t.the_record),_["\u0275\u0275advance"](3),_["\u0275\u0275property"]("ngIf",t.the_record))},directives:[s.IonHeader,s.IonToolbar,s.IonButtons,s.IonBackButton,s.IonBackButtonDelegate,s.IonTitle,i.NgIf,s.IonContent,s.IonList,s.IonItem,s.IonLabel,s.IonItemDivider,s.IonItemGroup,i.NgForOf,s.IonButton,s.IonGrid,s.IonRow,s.IonCol],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}"]}),e})()}];let C=(()=>{class e{}return e.\u0275mod=_["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.i.forChild(T)],r.i]}),e})();var O=n("DKVz");n.d(t,"StudentSelectPageModule",(function(){return j}));let j=(()=>{class e{}return e.\u0275mod=_["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.CommonModule,o.FormsModule,s.IonicModule,O.a,C]]}),e})()}}]);