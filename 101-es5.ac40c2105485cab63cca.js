function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{R0Hk:function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),r=n("3Pt+"),i=n("TEn/"),a=n("tyNb"),s=n("mrSG"),c=n("qXBG"),l=n("xG0Y"),d=n("D+jN"),u=n("LWQN"),m=n("jMEw"),h=n("fXoL");function f(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ion-chip",12),h["\u0275\u0275elementStart"](1,"ion-label"),h["\u0275\u0275text"](2),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](3,"ion-icon",13),h["\u0275\u0275listener"]("click",(function(){h["\u0275\u0275restoreView"](n);var e=t.$implicit;return h["\u0275\u0275nextContext"](3).remove(e)})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var o=t.$implicit;h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](o.name)}}function p(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"ion-grid"),h["\u0275\u0275elementStart"](1,"ion-row"),h["\u0275\u0275elementStart"](2,"ion-col"),h["\u0275\u0275template"](3,f,4,1,"ion-chip",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()),2&e){var n=h["\u0275\u0275nextContext"](2);h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngForOf",n.receive.data)}}function g(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ion-content"),h["\u0275\u0275elementStart"](1,"form",4,5),h["\u0275\u0275listener"]("ngSubmit",(function(){h["\u0275\u0275restoreView"](n);var e=h["\u0275\u0275reference"](2);return h["\u0275\u0275nextContext"]().submit(e)})),h["\u0275\u0275elementStart"](3,"ion-list"),h["\u0275\u0275elementStart"](4,"ion-item",6),h["\u0275\u0275elementStart"](5,"ion-label",7),h["\u0275\u0275elementStart"](6,"b"),h["\u0275\u0275text"](7,"\u63a5\u6536\u5bf9\u8c61\uff1a"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](8,p,4,1,"ion-grid",3),h["\u0275\u0275elementStart"](9,"ion-item"),h["\u0275\u0275elementStart"](10,"ion-input",8),h["\u0275\u0275listener"]("ngModelChange",(function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().the_model.title=e})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](11,"ion-item",6),h["\u0275\u0275elementStart"](12,"ion-textarea",9),h["\u0275\u0275listener"]("ngModelChange",(function(e){return h["\u0275\u0275restoreView"](n),h["\u0275\u0275nextContext"]().the_model.content=e})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](13,"ion-button",10),h["\u0275\u0275text"](14,"\u53d1\u9001"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){var o=h["\u0275\u0275reference"](2),r=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("ngIf",r.receive),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",r.the_model.title),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",r.the_model.content),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("disabled",o.invalid)}}var v,I,b=[{path:"",component:(v=function(){function e(t,n,o,r,i){_classCallCheck(this,e),this.cache=t,this.comm=n,this.ymsrv=o,this.auth=r,this.router=i,this.cache_key="message_publish"}return _createClass(e,[{key:"ngOnInit",value:function(){this.init()}},{key:"init",value:function(){var e;return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.cache.get(this.cache_key);case 2:if(this.receive=t.sent,null!=this.receive&&null!=this.receive&&0!=(null===(e=this.receive.data)||void 0===e?void 0:e.length)){t.next=5;break}return t.abrupt("return",(this.comm.presentToast("\u83b7\u53d6\u6570\u636e\u9519\u8bef\uff01"),void setTimeout((function(){history.back()}),2e3)));case 5:return t.next=7,this.auth.get_user();case 7:this.user=t.sent,this.the_model=new l.d,this.the_model.modeId=2,this.the_model.clickCount=0,this.the_model.createdBy=this.user.userName,this.the_model.isPush=!0,this.the_model.schoolId=this.user.serialNo,this.the_model.userId=this.user.userID,this.cache.remove(this.cache_key);case 16:case"end":return t.stop()}}),t,this)})))}},{key:"remove",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.receive.data.splice(this.receive.data.findIndex((function(t){return t.id==e.id})),1);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"submit",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.comm.loadingPresent(),(t=new l.e).type=this.receive.type_id,this.receive.data.forEach((function(e){t.userIds.push(e.id)})),0!=t.userIds.length){e.next=4;break}return e.abrupt("return",(this.comm.loadingDismiss(),void this.comm.presentToast("\u65e0\u63a5\u53d7\u5bf9\u8c61\uff0c\u65e0\u6cd5\u53d1\u9001\uff01")));case 4:return this.the_model.receives=t,e.next=7,this.ymsrv.message_publish(this.the_model);case 7:n=e.sent,this.comm.loadingDismiss(),0===n.code?(this.comm.presentToast("\u53d1\u9001\u6210\u529f\uff01"),setTimeout((function(){o.router.navigate(["tabs"],{replaceUrl:!0,skipLocationChange:!0})}),2e3)):this.comm.presentToast("\u53d1\u9001\u5931\u8d25\uff01");case 9:case"end":return e.stop()}}),e,this)})))}}]),e}(),v.\u0275fac=function(e){return new(e||v)(h["\u0275\u0275directiveInject"](d.a),h["\u0275\u0275directiveInject"](u.a),h["\u0275\u0275directiveInject"](m.a),h["\u0275\u0275directiveInject"](c.a),h["\u0275\u0275directiveInject"](a.g))},v.\u0275cmp=h["\u0275\u0275defineComponent"]({type:v,selectors:[["app-send-message"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","tabs"],[4,"ngIf"],[3,"ngSubmit"],["form","ngForm"],["lines","none"],["position","fixed"],["name","phone","type","text","placeholder","\u4e3b\u9898","clearInput","true","required","",3,"ngModel","ngModelChange"],["name","intro","placeholder","\u8bf7\u8f93\u5165\u6d88\u606f\u5185\u5bb9","required","","rows","20",2,"font-size","14px",3,"ngModel","ngModelChange"],["expand","block","type","submit",3,"disabled"],["color","blues",4,"ngFor","ngForOf"],["color","blues"],["name","close-outline",3,"click"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"ion-header",0),h["\u0275\u0275elementStart"](1,"ion-toolbar"),h["\u0275\u0275elementStart"](2,"ion-buttons",1),h["\u0275\u0275element"](3,"ion-back-button",2),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](4,"ion-title"),h["\u0275\u0275text"](5,"\u6d88\u606f\u53d1\u9001"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](6,g,15,4,"ion-content",3),h["\u0275\u0275element"](7,"ion-footer")),2&e&&(h["\u0275\u0275advance"](6),h["\u0275\u0275property"]("ngIf",t.the_model))},directives:[i.IonHeader,i.IonToolbar,i.IonButtons,i.IonBackButton,i.IonBackButtonDelegate,i.IonTitle,o.NgIf,i.IonFooter,i.IonContent,r["\u0275angular_packages_forms_forms_y"],r.NgControlStatusGroup,r.NgForm,i.IonList,i.IonItem,i.IonLabel,i.IonInput,i.TextValueAccessor,r.RequiredValidator,r.NgControlStatus,r.NgModel,i.IonTextarea,i.IonButton,i.IonGrid,i.IonRow,i.IonCol,o.NgForOf,i.IonChip,i.IonIcon],styles:["ion-icon[_ngcontent-%COMP%]{font-size:.8rem}ion-grid[_ngcontent-%COMP%]{--ion-grid-padding:0}ion-col[_ngcontent-%COMP%]{--ion-grid-column-padding:5px 0;margin-top:.5rem}"]}),v)}],_=((I=function e(){_classCallCheck(this,e)}).\u0275mod=h["\u0275\u0275defineNgModule"]({type:I}),I.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(e){return new(e||I)},imports:[[a.i.forChild(b)],a.i]}),I);n.d(t,"SendMessagePageModule",(function(){return x}));var C,x=((C=function e(){_classCallCheck(this,e)}).\u0275mod=h["\u0275\u0275defineNgModule"]({type:C}),C.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(e){return new(e||C)},imports:[[o.CommonModule,r.FormsModule,i.IonicModule,_]]}),C)}}]);