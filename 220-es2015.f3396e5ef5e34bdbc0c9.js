(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{"1Uze":function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),i=n("3Pt+"),s=n("TEn/"),r=n("tyNb"),d=n("mrSG"),l=n("ed2z"),a=n("LWQN"),m=n("jMEw"),c=n("qXBG"),h=n("fXoL");function u(e,t){if(1&e){const e=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ion-content",3),h["\u0275\u0275elementStart"](1,"form",4,5),h["\u0275\u0275listener"]("ngSubmit",(function(){h["\u0275\u0275restoreView"](e);const t=h["\u0275\u0275reference"](2);return h["\u0275\u0275nextContext"]().bindUser(t)})),h["\u0275\u0275elementStart"](3,"ion-list"),h["\u0275\u0275elementStart"](4,"ion-item"),h["\u0275\u0275elementStart"](5,"ion-avatar"),h["\u0275\u0275element"](6,"img",6),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](7,"ion-label"),h["\u0275\u0275elementStart"](8,"h2"),h["\u0275\u0275text"](9),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](10,"p"),h["\u0275\u0275text"](11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](12,"ion-item",7),h["\u0275\u0275elementStart"](13,"ion-input",8),h["\u0275\u0275listener"]("ngModelChange",(function(t){return h["\u0275\u0275restoreView"](e),h["\u0275\u0275nextContext"]().the_model.phone=t})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](14,"ion-item",7),h["\u0275\u0275elementStart"](15,"ion-input",9),h["\u0275\u0275listener"]("ngModelChange",(function(t){return h["\u0275\u0275restoreView"](e),h["\u0275\u0275nextContext"]().the_model.verifyCode=t})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](16,"ion-badge",10),h["\u0275\u0275listener"]("click",(function(){return h["\u0275\u0275restoreView"](e),h["\u0275\u0275nextContext"]().sendSms()})),h["\u0275\u0275text"](17),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](18,"div",11),h["\u0275\u0275elementStart"](19,"ion-button",12),h["\u0275\u0275text"](20,"\u63d0\u4ea4"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){const e=h["\u0275\u0275reference"](2),t=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](6),h["\u0275\u0275property"]("src",t.user.avatarUrl,h["\u0275\u0275sanitizeUrl"]),h["\u0275\u0275advance"](3),h["\u0275\u0275textInterpolate2"](" \xa0 ",t.user.accountName," / ",t.user.userName," "),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate1"](" \xa0\xa0",t.user.mobileNo," "),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",t.the_model.phone),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",t.the_model.verifyCode),h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](t.secondText),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("disabled",e.invalid)}}const p=[{path:"",component:(()=>{class e{constructor(e,t,n,o){this.common=e,this.ymsrv=t,this.router=n,this.auth=o,this.the_model=new l.a,this.second=0,this.secondText="\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801"}ngOnInit(){this.init()}init(){return Object(d.a)(this,void 0,void 0,(function*(){this.user=yield this.auth.get_user(),this.token=yield this.auth.get_token()}))}sendSms(){return Object(d.a)(this,void 0,void 0,(function*(){if(0==this.second)if(""!=this.the_model.phone&&null!=this.the_model.phone)if(/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.the_model.phone))if(this.user.mobileNo!=this.the_model.phone){var e=yield this.common.loadingPresent("\u6b63\u5728\u53d1\u9001\u77ed\u4fe1......");try{if(0==(yield this.ymsrv.existsPhoneUser(this.user.userID,this.the_model.phone,this.token)).code)return void this.common.presentToast("\u624b\u673a\u53f7\u7801\uff1a"+this.the_model.phone+"\u5df2\u88ab\u5176\u4ed6\u8d26\u53f7\u4f7f\u7528\uff01");var t=yield this.ymsrv.sendSms(this.the_model.phone,this.token);if(0==t.code){this.second=60,yield this.common.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u5df2\u81f3\u8be5\u624b\u673a\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff0c\u82e5\u957f\u65f6\u95f4\u672a\u6536\u5230\u9a8c\u8bc1\u7801\uff0c\u8bf7\u81f3\u201c\u5df2\u62e6\u622a\u77ed\u4fe1\u5217\u8868\u201d\u4e2d\u786e\u8ba4",["\u597d\u7684"]),this.secondText="\u91cd\u65b0\u53d1\u9001 "+this.second;var n=setInterval(()=>{this.secondText="\u91cd\u65b0\u53d1\u9001 "+--this.second,0==this.second&&(this.secondText="\u91cd\u65b0\u53d1\u9001",clearInterval(n))},1e3)}else this.common.presentToast(t.msg)}catch(o){}finally{e.dismiss()}}else this.common.presentToast("\u66f4\u6362\u7684\u624b\u673a\u53f7\u7801\u4e0d\u80fd\u4e0e\u539f\u53f7\u7801\u4e00\u81f4\uff01");else this.common.presentToast("\u624b\u673a\u53f7\u7801\u6709\u8bef\uff0c\u8bf7\u91cd\u586b");else this.common.presentToast("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7\u7801\uff01")}))}bindUser(e){return Object(d.a)(this,void 0,void 0,(function*(){var e=yield this.common.loadingPresent("\u5904\u7406\u4e2d......."),t=yield this.ymsrv.validVerifyCode(this.the_model.phone,this.the_model.verifyCode,this.token);if(0!=t.code)return this.common.presentToast(t.msg),void e.dismiss();let n=new FormData;n.append("Id",this.user.userID),n.append("MobileNo",this.the_model.phone);var o=yield this.ymsrv.change_mobile(n);if(e.dismiss(),0==o.code){var i=yield this.auth.get_user();i.mobileNo=this.the_model.phone,yield this.auth.set_user(i),this.common.presentToast("\u66f4\u6362\u624b\u673a\u53f7\u7801\u6210\u529f\uff01","success"),setTimeout(()=>{history.back()},2e3)}else this.common.presentToast(o.msg)}))}}return e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](a.a),h["\u0275\u0275directiveInject"](m.a),h["\u0275\u0275directiveInject"](r.g),h["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["app-change-phone"]],decls:7,vars:1,consts:[["slot","start"],["defaultHref","tabs"],["style","padding: 40px;",4,"ngIf"],[2,"padding","40px"],[3,"ngSubmit"],["form","ngForm"],[3,"src"],[1,"ion-no-padding","ion-text-sm-left"],["name","phone","type","text","placeholder","\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801","clearInput","true","inputmode","tel","required","",3,"ngModel","ngModelChange"],["name","verifycode","type","number","placeholder","\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801","inputmode","numeric","clearInput","true","maxlength","6","required","",3,"ngModel","ngModelChange"],["color","light","slot","end",3,"click"],[2,"margin-top","30px"],["type","submit","expand","block",3,"disabled"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"ion-header"),h["\u0275\u0275elementStart"](1,"ion-toolbar"),h["\u0275\u0275elementStart"](2,"ion-buttons",0),h["\u0275\u0275element"](3,"ion-back-button",1),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](4,"ion-title"),h["\u0275\u0275text"](5,"\u7ed1\u5b9a\u624b\u673a"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](6,u,21,8,"ion-content",2)),2&e&&(h["\u0275\u0275advance"](6),h["\u0275\u0275property"]("ngIf",t.user))},directives:[s.IonHeader,s.IonToolbar,s.IonButtons,s.IonBackButton,s.IonBackButtonDelegate,s.IonTitle,o.NgIf,s.IonContent,i["\u0275angular_packages_forms_forms_y"],i.NgControlStatusGroup,i.NgForm,s.IonList,s.IonItem,s.IonAvatar,s.IonLabel,s.IonInput,s.TextValueAccessor,i.RequiredValidator,i.NgControlStatus,i.NgModel,s.NumericValueAccessor,i.MaxLengthValidator,s.IonBadge,s.IonButton],styles:["ion-content[_ngcontent-%COMP%]{--padding-start:20px;--padding-end:20px;--padding-top:20px;--padding-bottom:20px}ion-badge[_ngcontent-%COMP%]{--padding-top:8px;--padding-bottom:8px}"]}),e})()}];let g=(()=>{class e{}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.i.forChild(p)],r.i]}),e})();n.d(t,"ChangePhonePageModule",(function(){return f}));let f=(()=>{class e{}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.CommonModule,i.FormsModule,s.IonicModule,g]]}),e})()}}]);