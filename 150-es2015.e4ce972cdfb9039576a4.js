(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{"6rk5":function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),r=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),s=n("mrSG"),l=n("gYr8"),h=n("m6cF"),d=n("26ZW"),c=n("KCVp"),m=n("qXBG"),u=n("AytR"),_=n("cq/f"),p=n("LWQN"),f=n("wd/R"),v=n("fXoL"),g=n("mQC6"),y=n("DL8m");function b(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"app-list-indicators",9),v["\u0275\u0275listener"]("selected",(function(t){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().select_indicators(t)})),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"]();v["\u0275\u0275property"]("the_filter",e.the_indicator_filter)("hasCheckbox",!0)}}const I=[{path:"",component:(()=>{class e{constructor(e,t,n,i,r,o){this.route=e,this.osrv=t,this.toast=n,this.router=i,this.auth=r,this.comm=o,this.the_indicator_filter=new h.a,this.the_filter=new l.c,this.the_model=new c.b,this.the_indicator=new Array,this.is_submit=!1,this.the_indicator_filter.type=2,this.the_date=f().format("YYYY-MM-DD"),this.the_max=f().locale("zh-cn").format("YYYY-MM-DD")}ngOnInit(){}ionViewWillEnter(){this.route.paramMap.subscribe(e=>Object(s.a)(this,void 0,void 0,(function*(){this.the_model.DateTime=e.get("date"),this.comm.loadingPresent(),this.osrv.get_student(e.get("id")).then(e=>{this.the_record=e.data,null!=this.the_record.avatar&&""!=this.the_record.avatar||(this.the_record.avatar=u.a.default_avatar),this.init(),this.comm.loadingDismiss()})})))}init(){return Object(s.a)(this,void 0,void 0,(function*(){let e;e=yield this.auth.get_user(),this.the_model.type=2,this.the_model.By=e.accountName,this.the_model.ByUserName=e.userName}))}select_indicators(e){e.selected?this.the_indicator.push(e):this.the_indicator.splice(this.the_indicator.indexOf(e),1)}submit(e){return Object(s.a)(this,void 0,void 0,(function*(){if(this.is_submit)return void this.comm.presentToast("\u4f60\u5df2\u63d0\u4ea4\uff0c\u8bf7\u4e0d\u8981\u91cd\u590d\u63d0\u4ea4\uff01");if(this.is_submit=!0,0==this.the_indicator.length)return this.is_submit=!1,void this.comm.presentToast("\u8bf7\u9009\u62e9\u9700\u8981\u8003\u8bc4\u7684\u6307\u6807\uff01");if(""==this.the_model.Where||null==this.the_model.Where||null==this.the_model.Where)return this.comm.presentToast("\u8bf7\u8f93\u5165\u63cf\u8ff0"),void(this.is_submit=!1);var e=yield this.comm.loadingPresent();let t=new Array,n=new Array,i=new Array;t.push(this.the_record.id),this.the_indicator.forEach(e=>{n.push(e.id)}),this.uploader.the_records.forEach(e=>{let t=new c.c;t.Name=e.name,t.Url=e.url,i.push(t)}),this.the_model.student_ids=t,this.the_model.id=n,this.the_model.Photo_Urls=i,this.the_model.DateTime=this.the_date;var r=yield this.osrv.create_charactor(this.the_model);e.dismiss(),this.is_submit=!1,0===r.code?this.comm.presentAlert("\u8003\u8bc4\u6210\u529f\uff01",null,"\u5b66\u751f\u8003\u8bc4\u6210\u529f\uff0c\u8bf7\u95ee\u60a8\u8981\u7ee7\u7eed\u64cd\u4f5c\u5417\uff1f",[{text:"\u505c\u7559\u5728\u5f53\u524d\u9875\u9762",handler:e=>{this.the_indicator=[],this.the_indicator_filter=null,this.the_indicator_filter=new h.a,this.the_indicator_filter.type=2,this.the_model.Where="",this.the_model.id=[],this.the_indicator=[],this.uploader.the_records=[],this.ionViewWillEnter()}},{text:"\u8fd4\u56de\u81f3\u5217\u8868",handler:e=>{this.router.navigate(["character/incampus"],{replaceUrl:!0,skipLocationChange:!0})}}]):this.comm.presentAlert("\u8003\u8bc4\u5931\u8d25\uff01",null,r.msg,[{text:"\u786e\u5b9a"}])}))}}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](a.a),v["\u0275\u0275directiveInject"](d.a),v["\u0275\u0275directiveInject"](o.ToastController),v["\u0275\u0275directiveInject"](a.g),v["\u0275\u0275directiveInject"](m.a),v["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-create"]],viewQuery:function(e,t){var n;1&e&&v["\u0275\u0275viewQuery"](_.a,!0),2&e&&v["\u0275\u0275queryRefresh"](n=v["\u0275\u0275loadQuery"]())&&(t.uploader=n.first)},decls:24,vars:5,consts:[["slot","start"],["defaultHref","tabs"],[3,"record"],[3,"the_filter","hasCheckbox","selected",4,"ngIf"],[2,"color","#949393"],["displayFormat","YYYY/MM/DD","required","","cancelText","\u53d6\u6d88","doneText","\u786e\u5b9a",3,"max","ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[1,"mt20"],["expand","block","color","primary",3,"click"],[3,"the_filter","hasCheckbox","selected"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"ion-header"),v["\u0275\u0275elementStart"](1,"ion-toolbar"),v["\u0275\u0275elementStart"](2,"ion-buttons",0),v["\u0275\u0275element"](3,"ion-back-button",1),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](4,"ion-title"),v["\u0275\u0275text"](5,"\u6821\u56ed\u5de1\u67e5"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](6,"ion-content"),v["\u0275\u0275elementStart"](7,"ion-list"),v["\u0275\u0275element"](8,"app-student-title",2),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](9,b,1,2,"app-list-indicators",3),v["\u0275\u0275elementStart"](10,"ion-item"),v["\u0275\u0275elementStart"](11,"ion-label"),v["\u0275\u0275elementStart"](12,"h3",4),v["\u0275\u0275text"](13," \u8bf7\u9009\u62e9\u65e5\u671f "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](14,"ion-datetime",5),v["\u0275\u0275listener"]("ngModelChange",(function(e){return t.the_date=e})),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](15,"ion-item"),v["\u0275\u0275elementStart"](16,"ion-label"),v["\u0275\u0275elementStart"](17,"h3",4),v["\u0275\u0275text"](18," \u8bf7\u8f93\u5165\u63cf\u8ff0 "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](19,"ion-textarea",6),v["\u0275\u0275listener"]("ngModelChange",(function(e){return t.the_model.Where=e})),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275element"](20,"div",7),v["\u0275\u0275element"](21,"app-upload-picture"),v["\u0275\u0275elementStart"](22,"ion-button",8),v["\u0275\u0275listener"]("click",(function(e){return t.submit(e)})),v["\u0275\u0275text"](23," \u63d0\u4ea4 "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e&&(v["\u0275\u0275advance"](8),v["\u0275\u0275property"]("record",t.the_record),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",t.the_indicator_filter),v["\u0275\u0275advance"](5),v["\u0275\u0275propertyInterpolate"]("max",t.the_max),v["\u0275\u0275property"]("ngModel",t.the_date),v["\u0275\u0275advance"](5),v["\u0275\u0275property"]("ngModel",t.the_model.Where))},directives:[o.IonHeader,o.IonToolbar,o.IonButtons,o.IonBackButton,o.IonBackButtonDelegate,o.IonTitle,o.IonContent,o.IonList,g.a,i.NgIf,o.IonItem,o.IonLabel,o.IonDatetime,o.SelectValueAccessor,r.RequiredValidator,r.NgControlStatus,r.NgModel,o.IonTextarea,o.TextValueAccessor,_.a,o.IonButton,y.a],styles:[""]}),e})()}];let w=(()=>{class e{}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.i.forChild(I)],a.i]}),e})();var x=n("Ql/B");n.d(t,"CreatePageModule",(function(){return M}));let M=(()=>{class e{}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.CommonModule,r.FormsModule,o.IonicModule,w,x.a]]}),e})()}}]);