function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{"1Uze":function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),r=n("3Pt+"),s=n("TEn/"),i=n("tyNb"),a=n("mrSG"),c=n("ed2z"),d=n("LWQN"),l=n("jMEw"),m=n("qXBG"),u=n("fXoL");function h(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ion-content",3),u["\u0275\u0275elementStart"](1,"form",4,5),u["\u0275\u0275listener"]("ngSubmit",(function(){u["\u0275\u0275restoreView"](n);var e=u["\u0275\u0275reference"](2);return u["\u0275\u0275nextContext"]().bindUser(e)})),u["\u0275\u0275elementStart"](3,"ion-list"),u["\u0275\u0275elementStart"](4,"ion-item"),u["\u0275\u0275elementStart"](5,"ion-avatar"),u["\u0275\u0275element"](6,"img",6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"ion-label"),u["\u0275\u0275elementStart"](8,"h2"),u["\u0275\u0275text"](9),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](12,"ion-item",7),u["\u0275\u0275elementStart"](13,"ion-input",8),u["\u0275\u0275listener"]("ngModelChange",(function(e){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().the_model.phone=e})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](14,"ion-item",7),u["\u0275\u0275elementStart"](15,"ion-input",9),u["\u0275\u0275listener"]("ngModelChange",(function(e){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().the_model.verifyCode=e})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](16,"ion-badge",10),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().sendSms()})),u["\u0275\u0275text"](17),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](18,"div",11),u["\u0275\u0275elementStart"](19,"ion-button",12),u["\u0275\u0275text"](20,"\u63d0\u4ea4"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){var o=u["\u0275\u0275reference"](2),r=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("src",r.user.avatarUrl,u["\u0275\u0275sanitizeUrl"]),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate2"](" \xa0 ",r.user.accountName," / ",r.user.userName," "),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"](" \xa0\xa0",r.user.mobileNo," "),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngModel",r.the_model.phone),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngModel",r.the_model.verifyCode),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate"](r.secondText),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("disabled",o.invalid)}}var p,f,g=[{path:"",component:(p=function(){function e(t,n,o,r){_classCallCheck(this,e),this.common=t,this.ymsrv=n,this.router=o,this.auth=r,this.the_model=new c.a,this.second=0,this.secondText="\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801"}return _createClass(e,[{key:"ngOnInit",value:function(){this.init()}},{key:"init",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.get_user();case 2:return this.user=e.sent,e.next=5,this.auth.get_token();case 5:this.token=e.sent;case 6:case"end":return e.stop()}}),e,this)})))}},{key:"sendSms",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.second){e.next=41;break}if(""==this.the_model.phone||null==this.the_model.phone){e.next=40;break}if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.the_model.phone)){e.next=37;break}if(this.user.mobileNo==this.the_model.phone){e.next=34;break}return e.next=6,this.common.loadingPresent("\u6b63\u5728\u53d1\u9001\u77ed\u4fe1......");case 6:return t=e.sent,e.prev=7,e.next=10,this.ymsrv.existsPhoneUser(this.user.userID,this.the_model.phone,this.token);case 10:if(e.t0=e.sent.code,0!=e.t0){e.next=13;break}return e.abrupt("return",void this.common.presentToast("\u624b\u673a\u53f7\u7801\uff1a"+this.the_model.phone+"\u5df2\u88ab\u5176\u4ed6\u8d26\u53f7\u4f7f\u7528\uff01"));case 13:return e.next=15,this.ymsrv.sendSms(this.the_model.phone,this.token);case 15:if(0!=(n=e.sent).code){e.next=24;break}return this.second=60,e.next=20,this.common.presentAlert("\u6e29\u99a8\u63d0\u793a",null,"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u5df2\u81f3\u8be5\u624b\u673a\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff0c\u82e5\u957f\u65f6\u95f4\u672a\u6536\u5230\u9a8c\u8bc1\u7801\uff0c\u8bf7\u81f3\u201c\u5df2\u62e6\u622a\u77ed\u4fe1\u5217\u8868\u201d\u4e2d\u786e\u8ba4",["\u597d\u7684"]);case 20:this.secondText="\u91cd\u65b0\u53d1\u9001 "+this.second,o=setInterval((function(){r.secondText="\u91cd\u65b0\u53d1\u9001 "+--r.second,0==r.second&&(r.secondText="\u91cd\u65b0\u53d1\u9001",clearInterval(o))}),1e3),e.next=25;break;case 24:this.common.presentToast(n.msg);case 25:e.next=29;break;case 27:e.prev=27,e.t1=e.catch(7);case 29:return e.prev=29,t.dismiss(),e.finish(29);case 32:e.next=35;break;case 34:this.common.presentToast("\u66f4\u6362\u7684\u624b\u673a\u53f7\u7801\u4e0d\u80fd\u4e0e\u539f\u53f7\u7801\u4e00\u81f4\uff01");case 35:e.next=38;break;case 37:this.common.presentToast("\u624b\u673a\u53f7\u7801\u6709\u8bef\uff0c\u8bf7\u91cd\u586b");case 38:e.next=41;break;case 40:this.common.presentToast("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7\u7801\uff01");case 41:case"end":return e.stop()}}),e,this,[[7,27,29,32]])})))}},{key:"bindUser",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.common.loadingPresent("\u5904\u7406\u4e2d.......");case 2:return t=e.sent,e.next=5,this.ymsrv.validVerifyCode(this.the_model.phone,this.the_model.verifyCode,this.token);case 5:if(0==(n=e.sent).code){e.next=8;break}return e.abrupt("return",(this.common.presentToast(n.msg),void t.dismiss()));case 8:return(o=new FormData).append("Id",this.user.userID),o.append("MobileNo",this.the_model.phone),e.next=12,this.ymsrv.change_mobile(o);case 12:if(r=e.sent,t.dismiss(),0!=r.code){e.next=24;break}return e.next=16,this.auth.get_user();case 16:return(s=e.sent).mobileNo=this.the_model.phone,e.next=20,this.auth.set_user(s);case 20:this.common.presentToast("\u66f4\u6362\u624b\u673a\u53f7\u7801\u6210\u529f\uff01","success"),setTimeout((function(){history.back()}),2e3),e.next=25;break;case 24:this.common.presentToast(r.msg);case 25:case"end":return e.stop()}}),e,this)})))}}]),e}(),p.\u0275fac=function(e){return new(e||p)(u["\u0275\u0275directiveInject"](d.a),u["\u0275\u0275directiveInject"](l.a),u["\u0275\u0275directiveInject"](i.g),u["\u0275\u0275directiveInject"](m.a))},p.\u0275cmp=u["\u0275\u0275defineComponent"]({type:p,selectors:[["app-change-phone"]],decls:7,vars:1,consts:[["slot","start"],["defaultHref","tabs"],["style","padding: 40px;",4,"ngIf"],[2,"padding","40px"],[3,"ngSubmit"],["form","ngForm"],[3,"src"],[1,"ion-no-padding","ion-text-sm-left"],["name","phone","type","text","placeholder","\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801","clearInput","true","inputmode","tel","required","",3,"ngModel","ngModelChange"],["name","verifycode","type","number","placeholder","\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801","inputmode","numeric","clearInput","true","maxlength","6","required","",3,"ngModel","ngModelChange"],["color","light","slot","end",3,"click"],[2,"margin-top","30px"],["type","submit","expand","block",3,"disabled"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-header"),u["\u0275\u0275elementStart"](1,"ion-toolbar"),u["\u0275\u0275elementStart"](2,"ion-buttons",0),u["\u0275\u0275element"](3,"ion-back-button",1),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](4,"ion-title"),u["\u0275\u0275text"](5,"\u7ed1\u5b9a\u624b\u673a"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](6,h,21,8,"ion-content",2)),2&e&&(u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("ngIf",t.user))},directives:[s.IonHeader,s.IonToolbar,s.IonButtons,s.IonBackButton,s.IonBackButtonDelegate,s.IonTitle,o.NgIf,s.IonContent,r["\u0275angular_packages_forms_forms_y"],r.NgControlStatusGroup,r.NgForm,s.IonList,s.IonItem,s.IonAvatar,s.IonLabel,s.IonInput,s.TextValueAccessor,r.RequiredValidator,r.NgControlStatus,r.NgModel,s.NumericValueAccessor,r.MaxLengthValidator,s.IonBadge,s.IonButton],styles:["ion-content[_ngcontent-%COMP%]{--padding-start:20px;--padding-end:20px;--padding-top:20px;--padding-bottom:20px}ion-badge[_ngcontent-%COMP%]{--padding-top:8px;--padding-bottom:8px}"]}),p)}],x=((f=function e(){_classCallCheck(this,e)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:f}),f.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||f)},imports:[[i.i.forChild(g)],i.i]}),f);n.d(t,"ChangePhonePageModule",(function(){return b}));var v,b=((v=function e(){_classCallCheck(this,e)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:v}),v.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||v)},imports:[[o.CommonModule,r.FormsModule,s.IonicModule,x]]}),v)}}]);