(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{R0Hk:function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),l=n("mrSG"),a=n("qXBG"),c=n("xG0Y"),d=n("D+jN"),m=n("LWQN"),u=n("jMEw"),h=n("fXoL");function p(e,t){if(1&e){const e=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ion-chip",12),h["\u0275\u0275elementStart"](1,"ion-label"),h["\u0275\u0275text"](2),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](3,"ion-icon",13),h["\u0275\u0275listener"]("click",(function(){h["\u0275\u0275restoreView"](e);const n=t.$implicit;return h["\u0275\u0275nextContext"](3).remove(n)})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;h["\u0275\u0275advance"](2),h["\u0275\u0275textInterpolate"](e.name)}}function g(e,t){if(1&e&&(h["\u0275\u0275elementStart"](0,"ion-grid"),h["\u0275\u0275elementStart"](1,"ion-row"),h["\u0275\u0275elementStart"](2,"ion-col"),h["\u0275\u0275template"](3,p,4,1,"ion-chip",11),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()),2&e){const e=h["\u0275\u0275nextContext"](2);h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngForOf",e.receive.data)}}function f(e,t){if(1&e){const e=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ion-content"),h["\u0275\u0275elementStart"](1,"form",4,5),h["\u0275\u0275listener"]("ngSubmit",(function(){h["\u0275\u0275restoreView"](e);const t=h["\u0275\u0275reference"](2);return h["\u0275\u0275nextContext"]().submit(t)})),h["\u0275\u0275elementStart"](3,"ion-list"),h["\u0275\u0275elementStart"](4,"ion-item",6),h["\u0275\u0275elementStart"](5,"ion-label",7),h["\u0275\u0275elementStart"](6,"b"),h["\u0275\u0275text"](7,"\u63a5\u6536\u5bf9\u8c61\uff1a"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](8,g,4,1,"ion-grid",3),h["\u0275\u0275elementStart"](9,"ion-item"),h["\u0275\u0275elementStart"](10,"ion-input",8),h["\u0275\u0275listener"]("ngModelChange",(function(t){return h["\u0275\u0275restoreView"](e),h["\u0275\u0275nextContext"]().the_model.title=t})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](11,"ion-item",6),h["\u0275\u0275elementStart"](12,"ion-textarea",9),h["\u0275\u0275listener"]("ngModelChange",(function(t){return h["\u0275\u0275restoreView"](e),h["\u0275\u0275nextContext"]().the_model.content=t})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](13,"ion-button",10),h["\u0275\u0275text"](14,"\u53d1\u9001"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()}if(2&e){const e=h["\u0275\u0275reference"](2),t=h["\u0275\u0275nextContext"]();h["\u0275\u0275advance"](8),h["\u0275\u0275property"]("ngIf",t.receive),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",t.the_model.title),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("ngModel",t.the_model.content),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("disabled",e.invalid)}}const v=[{path:"",component:(()=>{class e{constructor(e,t,n,o,i){this.cache=e,this.comm=t,this.ymsrv=n,this.auth=o,this.router=i,this.cache_key="message_publish"}ngOnInit(){this.init()}init(){var e;return Object(l.a)(this,void 0,void 0,(function*(){if(this.receive=yield this.cache.get(this.cache_key),null==this.receive||null==this.receive||0==(null===(e=this.receive.data)||void 0===e?void 0:e.length))return this.comm.presentToast("\u83b7\u53d6\u6570\u636e\u9519\u8bef\uff01"),void setTimeout(()=>{history.back()},2e3);this.user=yield this.auth.get_user(),this.the_model=new c.d,this.the_model.modeId=2,this.the_model.clickCount=0,this.the_model.createdBy=this.user.userName,this.the_model.isPush=!0,this.the_model.schoolId=this.user.serialNo,this.the_model.userId=this.user.userID,this.cache.remove(this.cache_key)}))}remove(e){return Object(l.a)(this,void 0,void 0,(function*(){this.receive.data.splice(this.receive.data.findIndex(t=>t.id==e.id),1)}))}submit(e){return Object(l.a)(this,void 0,void 0,(function*(){this.comm.loadingPresent();var e=new c.e;if(e.type=this.receive.type_id,this.receive.data.forEach(t=>{e.userIds.push(t.id)}),0==e.userIds.length)return this.comm.loadingDismiss(),void this.comm.presentToast("\u65e0\u63a5\u53d7\u5bf9\u8c61\uff0c\u65e0\u6cd5\u53d1\u9001\uff01");this.the_model.receives=e;var t=yield this.ymsrv.message_publish(this.the_model);this.comm.loadingDismiss(),0===t.code?(this.comm.presentToast("\u53d1\u9001\u6210\u529f\uff01"),setTimeout(()=>{this.router.navigate(["tabs"],{replaceUrl:!0,skipLocationChange:!0})},2e3)):this.comm.presentToast("\u53d1\u9001\u5931\u8d25\uff01")}))}}return e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](d.a),h["\u0275\u0275directiveInject"](m.a),h["\u0275\u0275directiveInject"](u.a),h["\u0275\u0275directiveInject"](a.a),h["\u0275\u0275directiveInject"](s.g))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["app-send-message"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","tabs"],[4,"ngIf"],[3,"ngSubmit"],["form","ngForm"],["lines","none"],["position","fixed"],["name","phone","type","text","placeholder","\u4e3b\u9898","clearInput","true","required","",3,"ngModel","ngModelChange"],["name","intro","placeholder","\u8bf7\u8f93\u5165\u6d88\u606f\u5185\u5bb9","required","","rows","20",2,"font-size","14px",3,"ngModel","ngModelChange"],["expand","block","type","submit",3,"disabled"],["color","blues",4,"ngFor","ngForOf"],["color","blues"],["name","close-outline",3,"click"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"ion-header",0),h["\u0275\u0275elementStart"](1,"ion-toolbar"),h["\u0275\u0275elementStart"](2,"ion-buttons",1),h["\u0275\u0275element"](3,"ion-back-button",2),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](4,"ion-title"),h["\u0275\u0275text"](5,"\u6d88\u606f\u53d1\u9001"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](6,f,15,4,"ion-content",3),h["\u0275\u0275element"](7,"ion-footer")),2&e&&(h["\u0275\u0275advance"](6),h["\u0275\u0275property"]("ngIf",t.the_model))},directives:[r.IonHeader,r.IonToolbar,r.IonButtons,r.IonBackButton,r.IonBackButtonDelegate,r.IonTitle,o.NgIf,r.IonFooter,r.IonContent,i["\u0275angular_packages_forms_forms_y"],i.NgControlStatusGroup,i.NgForm,r.IonList,r.IonItem,r.IonLabel,r.IonInput,r.TextValueAccessor,i.RequiredValidator,i.NgControlStatus,i.NgModel,r.IonTextarea,r.IonButton,r.IonGrid,r.IonRow,r.IonCol,o.NgForOf,r.IonChip,r.IonIcon],styles:["ion-icon[_ngcontent-%COMP%]{font-size:.8rem}ion-grid[_ngcontent-%COMP%]{--ion-grid-padding:0}ion-col[_ngcontent-%COMP%]{--ion-grid-column-padding:5px 0;margin-top:.5rem}"]}),e})()}];let I=(()=>{class e{}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.i.forChild(v)],s.i]}),e})();n.d(t,"SendMessagePageModule",(function(){return b}));let b=(()=>{class e{}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.CommonModule,i.FormsModule,r.IonicModule,I]]}),e})()}}]);